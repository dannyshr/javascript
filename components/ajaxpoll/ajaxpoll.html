<html>
<head>
	<title>Javascript Poll</title>
</head>

<body onload="handleOnLoad();">
	<form id="frmPoll" >
		<table>
			<tr>
				<td>
					<table border="1">
						<tr bgcolor="skyblue">
							<th colspan="3">Poll 1</th>
						</tr>
						<tr bgcolor="skyblue">
							<th>Poll 1 Interval</th>
							<th>Poll 1 Count Down</th>
							<th>Poll 1 Control</th>
						</tr>
						<tr>
							<td id="poll1IntervalTd" name="poll1IntervalTd"></td>
							<td id="poll1CountdownTd" name="poll1CountdownTd"></td>
							<td>
								<table>
									<tr>
										<td style="display:none;"><input id="btnPoll1" name="btnPoll1" type="button" value="Poll 1 Button" onclick="clickButton(poll1,poll1ButtonId,poll1IntervalCountdownTdId,txtPoll1Id,poll1IntervalTdId);" /></td>
										<td><input type="text" id="txtPoll1Interval" name="txtPoll1Interval" value="" size="4" maxlength="3" /></td>
										<td><input id="btnPoll1Control" name="btnPoll1Control" type="button" value="Start" style="width:65px;" onclick="poll1.startPoll(poll1ButtonId,poll1IntervalCountdownTdId,txtPoll1Id,poll1IntervalTdId,poll1ControlButtonId);" /></td>
										<td><input id="btnPoll1Stop" name="btnPoll1Stop" type="button" value="Stop" style="width:65px;" onclick="poll1.stopPoll(poll1ButtonId,poll1IntervalCountdownTdId,txtPoll1Id,poll1IntervalTdId,poll1ControlButtonId);" /></td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
				<td>
					<table border="1">
						<tr bgcolor="skyblue">
							<th colspan="3">Poll 2</th>
						</tr>
						<tr bgcolor="skyblue">
							<th>Poll 2 Interval</th>
							<th>Poll 2 Count Down</th>
							<th>Poll 2 Control</th>
						</tr>
						<tr>
							<td id="poll2IntervalTd" name="poll2IntervalTd"></td>
							<td id="poll2CountdownTd" name="poll2CountdownTd"></td>
							<td>
								<table>
									<tr>
										<td style="display:none;"><input id="btnPoll2" name="btnPoll2" type="button" value="Poll 2 Button" onclick="clickButton(poll2,poll2ButtonId,poll2IntervalCountdownTdId,txtPoll2Id,poll2IntervalTdId);" /></td>
										<td><input type="text" id="txtPoll2Interval" name="txtPoll2Interval" value="" size="4" maxlength="3" /></td>
										<td><input id="btnPoll2Control" name="btnPoll2Control" type="button" value="Start" style="width:65px;" onclick="poll2.startPoll(poll2ButtonId,poll2IntervalCountdownTdId,txtPoll2Id,poll2IntervalTdId,poll2ControlButtonId);" /></td>
										<td><input id="btnPoll2Stop" name="btnPoll2Stop" type="button" value="Stop" style="width:65px;" onclick="poll2.stopPoll(poll2ButtonId,poll2IntervalCountdownTdId,txtPoll2Id,poll2IntervalTdId,poll2ControlButtonId);" /></td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td><input id="btnAutoStart" name="btnAutoStart" type="button" value="Auto Start" onclick="autoStart();" /></td>
			</tr>
		</table>
	</form>
	<script src="resources/scripts/ajaxpoll.js" type="text/javascript"></script>
	<script type="text/javascript" language="JavaScript" >
	<!--
		//declare global variables
		var poll1Interval = 20;
		var poll2Interval = 20;
		var poll1 = null;
		var poll2 = null;
		var poll1IntervalTdId = "poll1IntervalTd";
		var poll2IntervalTdId = "poll2IntervalTd";
		var poll1IntervalCountdownTdId = "poll1CountdownTd";
		var poll2IntervalCountdownTdId = "poll2CountdownTd";
		var poll1ButtonId = "btnPoll1";
		var poll2ButtonId = "btnPoll2";
		var txtPoll1Id = "txtPoll1Interval";
		var txtPoll2Id = "txtPoll2Interval";
		var poll1ControlButtonId = "btnPoll1Control";
		var poll2ControlButtonId = "btnPoll2Control";
		var poll1StopButtonId = "btnPoll1Stop";
		var poll2StopButtonId = "btnPoll2Stop";
		
		function handleOnLoad() {
			//dclare locals
			var poll1IntervalTdObj = null;
			var poll2IntervalTdObj = null;
			var txtPoll1Obj = null;
			var txtPoll2Obj = null;
			var poll1IntervalCountdownTdObj = null;
			var poll2IntervalCountdownTdObj = null;
			
			//get elements by their ids
			poll1IntervalTdObj = document.getElementById(poll1IntervalTdId);
			poll2IntervalTdObj = document.getElementById(poll2IntervalTdId);
			txtPoll1Obj = document.getElementById(txtPoll1Id);
			txtPoll2Obj = document.getElementById(txtPoll2Id);
			poll1IntervalCountdownTdObj = document.getElementById(poll1IntervalCountdownTdId);
			poll2IntervalCountdownTdObj = document.getElementById(poll2IntervalCountdownTdId);
			
			//check for nulls
			if (poll1IntervalTdObj!=null) {
				poll1IntervalTdObj.innerHTML = poll1Interval;
			}
			if (poll2IntervalTdObj!=null) {
				poll2IntervalTdObj.innerHTML = poll2Interval;
			}
			if (txtPoll1Obj!=null) {
				txtPoll1Obj.value = poll1Interval;
			}
			if (txtPoll2Obj!=null) {
				txtPoll2Obj.value = poll2Interval;
			}
			if (poll1IntervalCountdownTdObj!=null) {
				poll1IntervalCountdownTdObj.innerHTML = poll1Interval;
			}
			if (poll2IntervalCountdownTdObj!=null) {
				poll2IntervalCountdownTdObj.innerHTML = poll2Interval;
			}
			
			//create new objects
			poll1 = new AjaxPoll();
			poll2 = new AjaxPoll();
		}
		
		function autoStart() {
			//declare locals
			var poll1ControlButtonObj = null;
			var poll2ControlButtonObj = null;
			
			//get elements by their ids
			poll1ControlButtonObj = document.getElementById(poll1ControlButtonId);
			poll2ControlButtonObj = document.getElementById(poll2ControlButtonId);
			
			//check for null objects
			if (poll1ControlButtonObj!=null) {
				poll1ControlButtonObj.click();
			}
			if (poll2ControlButtonObj!=null) {
				poll2ControlButtonObj.click();
			}
		}
		
		function clickButton(_pollObj,_pollButtonId,_pollIntervalCountdownTdId,_txtPollId,_pollIntervalTdId) {
			//dclare locals
			var _pollIntervalCountdownTdObj = null;
			var _txtPollObj = null;
			var _pollInterval = null;
			var _pollIntervalTdObj = null;
			
			//check for nulls
			if (_pollObj==null || _pollButtonId==null || _txtPollId==null || _pollIntervalTdId==null) {
				return;
			}
			
			//get elements by their ids
			_pollIntervalCountdownTdObj = document.getElementById(_pollIntervalCountdownTdId);
			_txtPollObj = document.getElementById(_txtPollId);
			_pollIntervalTdObj = document.getElementById(_pollIntervalTdId);
			
			//stop the poll
			_pollObj.stop();
			
			//reset display values
			if (_txtPollObj!=null) {
				_pollInterval = parseInt(_txtPollObj.value);
			}
			if (_pollIntervalTdObj!=null) {
				_pollIntervalTdObj.innerHTML = _pollInterval;
			}
			if (_pollIntervalCountdownTdObj!=null) {
				_pollIntervalCountdownTdObj.innerHTML = _pollInterval;
			}
			
			//show the button's action
			alert(_pollButtonId + ' was clicked...');
		
			//re-start the poll
			_pollObj.start(_pollButtonId,_pollInterval*1000,_pollIntervalCountdownTdId);
		}
		
	//-->
	</script>
</body>
</html>